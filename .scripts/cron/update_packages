#!/bin/sh
# Syncs repositories and downloads updates, meant to be run as a cronjob.

ScriptsDir=/home/daniel/.scripts

ping -q -c 1 1.1.1.1 > /dev/null || exit

"$ScriptsDir"/tools/notify-all -a "📦 Repository Sync" "Checking for package updates..."

sudo pacman -Syyuw --noconfirm || "$ScriptsDir"/tools/notify-all -a "📦 Repository Sync" "Error downloading updates. Check your internet connection, if pacman is already running, or run update manually to see errors."
pkill -RTMIN+8 i3blocks

if pacman -Qu | grep -v "\[ignored\]"
then
	"$ScriptsDir"/tools/notify-all -a "🎁 Repository Sync" "Updates available. Click statusbar icon (📦) for update."
else
	"$ScriptsDir"/tools/notify-all -a "📦 Repository Sync"  "Sync complete. No new packages for update."
fi
